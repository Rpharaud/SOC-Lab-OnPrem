| ID   | Edge Case Description                                | Log Source                  | Category                      | Validation Method                                                                | Status | Notes                                                          |
|------|------------------------------------------------------|-----------------------------|-------------------------------|----------------------------------------------------------------------------------|--------|----------------------------------------------------------------|
| EC1  | DNS spoofing & tunneling                             | Zeek - dns.log              | Covert Channel / C2           | Generate synthetic base64 TXT query using `dig` + detect with Zeek `dns_request` | ✅     | `Suspicious_DNS_Query` trigger                                 |
| EC2  | Poor SSH key management                              | Zeek - ssh.log              | Auth Weakness                 | Flag weak host key or cipher algorithms if detected in handshake                 | ✅     | Host config refused legacy cryptos; Zeek policy used           |
| EC3  | High-Frequency HTTP Requests                         | Zeek - http.log             | Spike / DoS                   | Simulate 1k+ HTTP GETs in PCAP + custom `detect_http_spike.zeek` triggers alert  | ✅     | Spike notice confirmed                                         |
| EC4  | Malformed Packets Missed by Suricata                 | Suricata - eve.json / fast.log | Evasion / Logging Gap         | Replay malformed HTTP PCAP, verify Suricata triggers alerts & logs consistently  | ✅     | Confirmed edge parsing coverage                                |
| EC5  | SSL Weak Cipher Usage                                | Zeek - ssl.log              | Crypto Weakness               | OpenSSL s_server with forced `-tls1_2` & `-cipher AES256-SHA`; Zeek flags weak ciphers | ✅ | Confirmed `Weak_Cipher` notice                                 |
| EC6  | Beaconing Traffic Detection                          | Zeek - conn.log + notice.log | C2 / Covert Channel           | Simulated ICMP beacon at intervals, detected by custom Zeek policy               | ✅     | Verified `Beacon_Fortify` trigger                              |
| EC7  | Reverse Shell Over Port 443                          | Zeek - conn.log             | Evasion / C2 Channel          | Simulated TCP reverse shell on 443, Zeek policy flagged unexpected service       | ✅     | Custom policy triggers `Shell_Notice`                          |
| EC8  | Large DNS TXT Record Exfiltration Attempt            | Zeek - dns.log              | Covert Channel / Exfiltration | Generate oversized `TXT` query + detect using DNS exfil policy                   | ✅     | Confirmed detection with `Suspicious_DNS_TXT`                  |
| EC9  | Logstash Dropping Malformed Zeek JSON                | Logstash                    | Parser Failure                | Injected broken JSON → verified `_jsonparsefailure` routed to `deadletter-zeek`  | ✅     | Validated Logstash `mutate` & fallback index                   |
| EC10 | Misrouted Pipeline (Wrong Index Pattern)             | Logstash                    | Misconfiguration              | Sent valid Zeek JSON missing `log_type` → misrouted to quarantine index          | ✅     | Validated conditional routing                                  |
| EC11 | Filebeat event truncation or partial shipping        | Filebeat                    | Incomplete Logs               | Send incomplete log (`uid=abc`), check `zeek-*`                                  | ✅          | Verified partial caused fallback to `wrongindex-*`.     |
| EC12 | Filebeat Multiline Failure on Zeek/Suricata Logs     | Filebeat                    | Parsing / Multiline Edge      | Nested JSON multi test joined with `multiline.pattern`                           | ✅     | Confirmed multiline block handling                             |
| EC13 | Index Template Mismatch                              | Elasticsearch               | Mapping Failure               | Routed valid Zeek JSON to `wrongindex-*` → simulated missing template            | ✅     | Confirmed dynamic mapping risk, enforced strict templates      |
| EC14 | Mapping Explosion from Dynamic Fields                | Elasticsearch               | Performance Risk              | Injected Zeek JSON with high-cardinality fields → forced mapping explosion test  | ✅     | Fixed with `dynamic: strict` & Logstash pruning                |
| EC15 | Ingest Failure — Type Conflict                       | Logstash → Elasticsearch    | Mapping Conflict              | Pushed numeric `uid` vs. keyword mapping → forced type conflict                  | ✅     | Fixed with `mutate` convert to string                          |
| EC16 | Metadata Gap — Arkime Missing Layers                 | Arkime                      | Indexing / Metadata Gap       | Replay minimal PCAP, SPIView shows `No data` for GEO/ASN, validated with field filter | ✅ | Arkime queries & field checks confirmed                        |
| EC17 | Arkime UI Render Failure — Large PCAP                | Arkime Viewer               | UI Performance                | Replay massive PCAP, SPIView timeout → chunked PCAP → confirmed stable rendering | ✅     | Max buckets raised, chunking & hardware plan confirmed         |
| EC18 | Field-Level Search Inconsistency — GEO & ASN         | Arkime Fields               | Parsing / GEO Mapping Gap     | Replay mixed IP PCAP → SPIView & field checks confirm GEO/ASN coverage & cron job | ✅ | GeoIP DB auto-refresh + field mapping verified                 |
